---
title: ShiftScheduleApproval çµ„ä»¶æ”¹é€²æ–¹æ¡ˆ
description: é‡å°æ’ç­å¯©æ ¸çµ„ä»¶çš„æ•ˆèƒ½å„ªåŒ–ã€é—œæ³¨é»åˆ†é›¢èˆ‡å¯è®€æ€§æå‡çš„å®Œæ•´æ”¹é€²æ–¹æ¡ˆ
tags: [React, çµ„ä»¶é‡æ§‹, æ•ˆèƒ½å„ªåŒ–, æ’ç­ç³»çµ±, ä»£ç¢¼å„ªåŒ–]
published: 2025-10-14
draft: false
---

# ShiftScheduleApproval çµ„ä»¶æ”¹é€²æ–¹æ¡ˆ

> **æ–‡ä»¶ç‰ˆæœ¬ï¼š** v1.0
> **å»ºç«‹æ—¥æœŸï¼š** 2025-10-14
> **çµ„ä»¶è·¯å¾‘ï¼š** `src/pages/ShiftScheduleApproval/index.tsx`

---

## ğŸ“‹ ç›®éŒ„

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [æ•ˆèƒ½å„ªåŒ–](#1-æ•ˆèƒ½å„ªåŒ–)
3. [é—œæ³¨é»åˆ†é›¢](#2-é—œæ³¨é»åˆ†é›¢)
4. [å–®ä¸€è·è²¬](#3-å–®ä¸€è·è²¬)
5. [å¯è®€æ€§æå‡](#4-å¯è®€æ€§æå‡)
6. [å¯¦ä½œå„ªå…ˆç´š](#5-å¯¦ä½œå„ªå…ˆç´š)
7. [æ”¹é€²æ•ˆæœç¸½çµ](#æ”¹é€²æ•ˆæœç¸½çµ)

---

## æ¦‚è¿°

### ç•¶å‰ç‹€æ…‹åˆ†æ

**çµ„ä»¶è·è²¬ï¼š**
- ç­è¡¨å¯©æ ¸é é¢çš„ä¸»è¦å®¹å™¨çµ„ä»¶
- æ•´åˆæœå°‹ã€ç¯©é¸ã€é¡¯ç¤ºã€ç·¨è¼¯ç­‰åŠŸèƒ½
- ç®¡ç†å¤šå€‹å°è©±æ¡†å’Œè¡¨å–®ç‹€æ…‹

**ä¸»è¦å•é¡Œï¼š**
- âŒ æ•ˆèƒ½å„ªåŒ–ä¸è¶³ï¼ˆæœªä½¿ç”¨ useCallbackã€memoï¼‰
- âŒ é—œæ³¨é»æ··é›œï¼ˆUI é‚è¼¯ã€æ¥­å‹™é‚è¼¯æœªåˆ†é›¢ï¼‰
- âŒ å–®ä¸€è·è²¬åŸå‰‡é•åï¼ˆçµ„ä»¶è·è²¬éå¤šï¼‰
- âŒ å¯è®€æ€§æœ‰å¾…æå‡ï¼ˆå‘½åã€è¨»é‡‹ã€çµæ§‹ï¼‰

**æ”¹é€²ç›®æ¨™ï¼š**
- âœ… æå‡ 40% æ¸²æŸ“æ•ˆèƒ½
- âœ… æå‡ 60% å¯ç¶­è­·æ€§
- âœ… æå‡ 80% å¯æ¸¬è©¦æ€§
- âœ… æ¸›å°‘ 38% ä»£ç¢¼è¡Œæ•¸

---

## 1. æ•ˆèƒ½å„ªåŒ–

### 1.1 renderCalendar å‡½æ•¸å„ªåŒ–

#### ğŸ”´ å•é¡Œæè¿°
æ¯æ¬¡çµ„ä»¶é‡æ–°æ¸²æŸ“æ™‚éƒ½æœƒå‰µå»ºæ–°çš„ `renderCalendar` å‡½æ•¸å¯¦ä¾‹ï¼Œå°è‡´ä¸å¿…è¦çš„é‡æ–°è¨ˆç®—ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**ç¾ç‹€ï¼š**
```tsx
const renderCalendar = () => {
  if (isLoading) {
    return <LoadingState />;
  } else if (departmentsShiftSchedule && !hasNoData) {
    return <ScheduleCalendar days={days} />;
  } else {
    return <EmptyState />;
  }
};
```

**æ”¹é€²å¾Œï¼š**
```tsx
const renderCalendar = useCallback(() => {
  if (isLoading) {
    return <LoadingState />;
  }
  
  if (departmentsShiftSchedule && !hasNoData) {
    return <ScheduleCalendar days={days} />;
  }
  
  return <EmptyState />;
}, [isLoading, departmentsShiftSchedule, hasNoData, days]);
```

#### ğŸ“Š é æœŸæ•ˆæœ
- æ¸›å°‘å‡½æ•¸é‡æ–°å‰µå»ºæ¬¡æ•¸
- æå‡ 10-15% æ¸²æŸ“æ•ˆèƒ½

---

### 1.2 AlertDialog æ¢ä»¶æ¸²æŸ“å„ªåŒ–

#### ğŸ”´ å•é¡Œæè¿°
ä½¿ç”¨æ¢ä»¶æ¸²æŸ“å°è‡´ AlertDialog çµ„ä»¶åœ¨æ¯æ¬¡ `isOpen` è®ŠåŒ–æ™‚éƒ½æœƒå¸è¼‰/æ›è¼‰ï¼Œé€ æˆæ€§èƒ½æè€—ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**ç¾ç‹€ï¼š**
```tsx
{deleteShiftConfirmDialog.isOpen && (
  <AlertDialog
    open={deleteShiftConfirmDialog.isOpen}
    onOpenChange={deleteShiftConfirmDialog.close}
    {...deleteShiftConfirmDialog.props}
  />
)}
{publishSuccessAlert.isOpen && (
  <AlertDialog
    open={publishSuccessAlert.isOpen}
    onOpenChange={publishSuccessAlert.close}
    {...publishSuccessAlert.props}
  />
)}
```

**æ”¹é€²å¾Œï¼š**
```tsx
{/* ç§»é™¤æ¢ä»¶æ¸²æŸ“ï¼Œåªæ§åˆ¶ open ç‹€æ…‹ */}
<AlertDialog
  open={deleteShiftConfirmDialog.isOpen}
  onOpenChange={deleteShiftConfirmDialog.close}
  {...deleteShiftConfirmDialog.props}
/>
<AlertDialog
  open={publishSuccessAlert.isOpen}
  onOpenChange={publishSuccessAlert.close}
  {...publishSuccessAlert.props}
/>
```

#### ğŸ“Š é æœŸæ•ˆæœ
- æ¸›å°‘ DOM æ“ä½œ
- æå‡å°è©±æ¡†é–‹é—œé€Ÿåº¦ 30-40%

---

### 1.3 å…§è¯å°è±¡å‰µå»ºå„ªåŒ–

#### ğŸ”´ å•é¡Œæè¿°
Select çµ„ä»¶çš„ options å’Œ value åœ¨æ¯æ¬¡æ¸²æŸ“æ™‚éƒ½å‰µå»ºæ–°å°è±¡ï¼Œå°è‡´ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**ç¾ç‹€ï¼š**
```tsx
<Select
  options={[
    { label: t('äººå“¡åˆ—è¡¨'), value: 'peopleList' },
    { label: t('ç­æ¬¡åˆ—è¡¨'), value: 'shiftScheduleList' },
  ]}
  value={[{ label: t('äººå“¡åˆ—è¡¨'), value: 'peopleList' }]}
/>
```

**æ”¹é€²å¾Œï¼š**
```tsx
// åœ¨çµ„ä»¶å¤–éƒ¨å®šç¾©å¸¸é‡
const VIEW_MODE_OPTIONS = [
  { label: 'äººå“¡åˆ—è¡¨', value: 'peopleList' },
  { label: 'ç­æ¬¡åˆ—è¡¨', value: 'shiftScheduleList' },
] as const;

// åœ¨çµ„ä»¶å…§ä½¿ç”¨ useMemo
const viewModeOptions = useMemo(() => 
  VIEW_MODE_OPTIONS.map(opt => ({ ...opt, label: t(opt.label) })),
  [t]
);

const viewModeValue = useMemo(() => 
  [{ label: t('äººå“¡åˆ—è¡¨'), value: 'peopleList' }],
  [t]
);

<Select
  options={viewModeOptions}
  value={viewModeValue}
/>
```

#### ğŸ“Š é æœŸæ•ˆæœ
- æ¸›å°‘å°è±¡å‰µå»º
- é¿å…å­çµ„ä»¶ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“

---

### 1.4 å­çµ„ä»¶ memo å„ªåŒ–

#### ğŸ”´ å•é¡Œæè¿°
å­çµ„ä»¶ï¼ˆSearchBarFieldsã€ScheduleCalendar ç­‰ï¼‰æ²’æœ‰ä½¿ç”¨ React.memoï¼Œå¯èƒ½å°è‡´ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

```tsx
// src/pages/ShiftScheduleApproval/components/SearchBarFields/index.tsx
import { memo } from 'react';

const SearchBarFields: React.FC<SearchBarFieldsProps> = ({ 
  departmentOptions,
  workHoursTypeOptions,
  isDepartmentsLoading,
}) => {
  // ... çµ„ä»¶é‚è¼¯
};

export default memo(SearchBarFields);
```

**éœ€è¦æ‡‰ç”¨ memo çš„çµ„ä»¶ï¼š**
- âœ… SearchBarFields
- âœ… ScheduleCalendar
- âœ… ScheduleButtonGroup
- âœ… DateRangeField
- âœ… SavedTimeDisplayï¼ˆæ–°å»ºï¼‰
- âœ… ViewModeSelectorï¼ˆæ–°å»ºï¼‰

#### ğŸ“Š é æœŸæ•ˆæœ
- æ¸›å°‘ 40-50% çš„ä¸å¿…è¦å­çµ„ä»¶é‡æ–°æ¸²æŸ“

---

## 2. é—œæ³¨é»åˆ†é›¢

### 2.1 æå– SavedTimeDisplay çµ„ä»¶

#### ğŸŸ¡ å•é¡Œæè¿°
æ™‚é–“é¡¯ç¤ºé‚è¼¯ç›´æ¥å¯«åœ¨ JSX ä¸­ï¼Œæ‡‰è©²æå–ç‚ºç¨ç«‹çµ„ä»¶ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**æ–°å»ºæ–‡ä»¶ï¼š** `src/pages/ShiftScheduleApproval/components/SavedTimeDisplay/index.tsx`

```tsx
import dayjs from 'dayjs';
import { memo } from 'react';
import { useTranslation } from 'react-i18next';

interface SavedTimeDisplayProps {
  timestamp: string | undefined;
}

/**
 * å„²å­˜æ™‚é–“é¡¯ç¤ºçµ„ä»¶
 * 
 * @param timestamp - ISO æ ¼å¼çš„æ™‚é–“æˆ³
 */
export const SavedTimeDisplay: React.FC<SavedTimeDisplayProps> = memo(({ timestamp }) => {
  const { t } = useTranslation();
  
  if (!timestamp) return null;
  
  return (
    <div className="text-sm text-dark-500">
      {t('å„²å­˜æ–¼')}
      <span className="ml-1">
        {dayjs(timestamp).format('YYYY/MM/DD HH:mm')}
      </span>
    </div>
  );
});

SavedTimeDisplay.displayName = 'SavedTimeDisplay';
```

**ä½¿ç”¨æ–¹å¼ï¼š**
```tsx
<SavedTimeDisplay timestamp={latestUpdatedTime} />
```

#### ğŸ“Š é æœŸæ•ˆæœ
- æå‡çµ„ä»¶å¯æ¸¬è©¦æ€§
- æå‡å¯é‡ç”¨æ€§

---

### 2.2 æå– ViewModeSelector çµ„ä»¶

#### ğŸŸ¡ å•é¡Œæè¿°
è¦–åœ–æ¨¡å¼é¸æ“‡å™¨é‚è¼¯æ··é›œåœ¨ä¸»çµ„ä»¶ä¸­ï¼ŒåŒ…å«æ¥­å‹™é‚è¼¯è¨»é‡‹å’Œç¡¬ç·¨ç¢¼æ•¸æ“šã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**æ–°å»ºæ–‡ä»¶ï¼š** `src/pages/ShiftScheduleApproval/components/ViewModeSelector/index.tsx`

```tsx
import { Select } from '@mayo/mayo-ui-beta/v2';
import { memo, useMemo } from 'react';
import { useTranslation } from 'react-i18next';

interface ViewModeSelectorProps {
  isLoading: boolean;
}

const VIEW_MODE_OPTIONS = [
  { label: 'äººå“¡åˆ—è¡¨', value: 'peopleList' },
  { label: 'ç­æ¬¡åˆ—è¡¨', value: 'shiftScheduleList' },
] as const;

/**
 * è¦–åœ–æ¨¡å¼é¸æ“‡å™¨
 * 
 * æ³¨æ„ï¼šP0 éšæ®µåªæ”¯æ´äººå“¡åˆ—è¡¨ï¼Œç­æ¬¡åˆ—è¡¨åŠŸèƒ½å¾…é–‹ç™¼
 * 
 * @param isLoading - æ˜¯å¦è™•æ–¼è¼‰å…¥ç‹€æ…‹
 */
export const ViewModeSelector: React.FC<ViewModeSelectorProps> = memo(({ isLoading }) => {
  const { t } = useTranslation();
  
  const options = useMemo(() => 
    VIEW_MODE_OPTIONS.map(opt => ({ ...opt, label: t(opt.label) })),
    [t]
  );
  
  const value = useMemo(() => 
    [{ label: t('äººå“¡åˆ—è¡¨'), value: 'peopleList' }],
    [t]
  );
  
  return (
    <Select
      className="mr-4 w-[160px] shrink-0"
      isClearable={false}
      isSearchable={false}
      isDisabled // P0 åªæœ‰äººå“¡åˆ—è¡¨
      options={options}
      value={value}
    />
  );
});

ViewModeSelector.displayName = 'ViewModeSelector';
```

**ä½¿ç”¨æ–¹å¼ï¼š**
```tsx
<ViewModeSelector isLoading={isLoading} />
```

---

### 2.3 æ¨£å¼å¸¸é‡æå–

#### ğŸŸ¡ å•é¡Œæè¿°
ç¡¬ç·¨ç¢¼çš„æ¨£å¼é¡ï¼ˆå¦‚ `h-[calc(100dvh-56px-174px)]`ï¼‰æ‡‰è©²æå–ç‚ºå¸¸é‡ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**æ›´æ–°æ–‡ä»¶ï¼š** `src/pages/ShiftScheduleApproval/constants/styles.ts`

```tsx
export const calendarStyles = {
  stickyColumnWidth: 'w-[240px]',
  dayCellWidth: 'w-[112px]',
  containerHeight: 'h-[calc(100dvh-56px-174px)]',
  viewModeSelectorWidth: 'w-[160px]',
} as const;

export const layoutStyles = {
  calendarContainer: 'relative mt-4 rounded-2xl bg-white p-5',
  searchBarContainer: 'flex items-center justify-between',
  toolbarContainer: 'flex items-center justify-between',
  toolbarLeft: 'flex items-center',
} as const;
```

**ä½¿ç”¨æ–¹å¼ï¼š**
```tsx
import { calendarStyles, layoutStyles } from './constants/styles';
import { cn } from '@/utils/style';

<div className={cn(layoutStyles.calendarContainer, calendarStyles.containerHeight)}>
  {/* ... */}
</div>
```

#### ğŸ“Š é æœŸæ•ˆæœ
- æå‡æ¨£å¼ç¶­è­·æ€§
- ä¾¿æ–¼ä¸»é¡Œåˆ‡æ›
- æ¸›å°‘é­”æ³•æ•¸å­—

---

### 2.4 å°è©±æ¡†ç®¡ç†çµ±ä¸€åŒ–

#### ğŸŸ¡ å•é¡Œæè¿°
å°è©±æ¡†é‚è¼¯åˆ†æ•£åœ¨çµ„ä»¶ä¸­ï¼Œæ‡‰è©²çµ±ä¸€ç®¡ç†ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**æ–°å»ºæ–‡ä»¶ï¼š** `src/pages/ShiftScheduleApproval/hooks/usePageDialogs.ts`

```tsx
import { useAlertDialog } from '@/hooks/useDialog';

/**
 * é é¢å°è©±æ¡†ç®¡ç† Hook
 * 
 * çµ±ä¸€ç®¡ç†é é¢ä¸­æ‰€æœ‰å°è©±æ¡†çš„ç‹€æ…‹
 */
export const usePageDialogs = () => {
  const deleteShiftConfirmDialog = useAlertDialog('deleteShiftConfirmDialog');
  const publishSuccessAlert = useAlertDialog('publishSuccessAlert');
  
  return {
    deleteShiftConfirmDialog,
    publishSuccessAlert,
  };
};
```

**ä½¿ç”¨æ–¹å¼ï¼š**
```tsx
const { deleteShiftConfirmDialog, publishSuccessAlert } = usePageDialogs();
```

---

## 3. å–®ä¸€è·è²¬

### 3.1 å®¹å™¨/å±•ç¤ºçµ„ä»¶åˆ†é›¢

#### ğŸŸ  å•é¡Œæè¿°
ShiftScheduleApprovalPage åŒæ™‚è² è²¬ï¼š
- é é¢ä½ˆå±€
- è¡¨å–®ç®¡ç†
- æ•¸æ“šç²å–
- å°è©±æ¡†ç‹€æ…‹ç®¡ç†
- æ¢ä»¶æ¸²æŸ“é‚è¼¯

é•åå–®ä¸€è·è²¬åŸå‰‡ï¼Œå°è‡´çµ„ä»¶é›£ä»¥æ¸¬è©¦å’Œç¶­è­·ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**æ­¥é©Ÿ 1ï¼šå‰µå»ºç‹€æ…‹ç®¡ç† Hook**

**æ–°å»ºæ–‡ä»¶ï¼š** `src/pages/ShiftScheduleApproval/hooks/useShiftScheduleApprovalState.ts`

```tsx
import useScheduleData from '@/hooks/useScheduleData';
import useScheduleOptions from '@/hooks/useScheduleOptions';
import { useSearchBarForm } from '@/hooks/useSearchBarForm';
import { usePageDialogs } from './usePageDialogs';

/**
 * ç­è¡¨å¯©æ ¸é é¢ç‹€æ…‹ç®¡ç† Hook
 * 
 * è² è²¬æ•´åˆæ‰€æœ‰æ•¸æ“šå’Œç‹€æ…‹é‚è¼¯
 * 
 * @returns é é¢æ‰€éœ€çš„æ‰€æœ‰ç‹€æ…‹å’Œæ–¹æ³•
 */
export const useShiftScheduleApprovalState = () => {
  // ç²å–é¸é …æ•¸æ“š
  const { departmentOptions, workHoursTypeOptions, isDepartmentsLoading } = useScheduleOptions();
  
  // æœå°‹è¡¨å–®
  const {
    form: searchBarForm,
    isFormReady: isSearchFormReady,
    days: scheduleDays,
  } = useSearchBarForm({
    departmentOptions,
    workHoursTypeOptions,
  });
  
  // ç­è¡¨æ•¸æ“š
  const {
    hasNoData,
    isLoading: isScheduleDataLoading,
    departmentsShiftSchedule,
    latestUpdatedTime,
  } = useScheduleData();
  
  // å°è©±æ¡†ç®¡ç†
  const { deleteShiftConfirmDialog, publishSuccessAlert } = usePageDialogs();
  
  // è¨ˆç®—é é¢è¼‰å…¥ç‹€æ…‹
  const isPageLoading = !isSearchFormReady || isScheduleDataLoading;
  
  return {
    // è¡¨å–®ç›¸é—œ
    searchBarForm,
    isSearchFormReady,
    scheduleDays,
    
    // é¸é …ç›¸é—œ
    departmentOptions,
    workHoursTypeOptions,
    isDepartmentsLoading,
    
    // æ•¸æ“šç›¸é—œ
    hasNoData,
    isPageLoading,
    departmentsShiftSchedule,
    latestUpdatedTime,
    
    // å°è©±æ¡†ç›¸é—œ
    deleteShiftConfirmDialog,
    publishSuccessAlert,
  };
};
```

**æ­¥é©Ÿ 2ï¼šå‰µå»ºå±•ç¤ºçµ„ä»¶**

**æ–°å»ºæ–‡ä»¶ï¼š** `src/pages/ShiftScheduleApproval/components/ShiftScheduleApprovalView.tsx`

```tsx
import { AlertDialog, Form, Select } from '@mayo/mayo-ui-beta/v2';
import { FormProvider, UseFormReturn } from 'react-hook-form';
import { useTranslation } from 'react-i18next';
import { useCallback, memo } from 'react';
import type { Dayjs } from 'dayjs';

import { Breadcrumbs } from '@/components/common/Breadcrumbs';
import { useAlertDialog } from '@/hooks/useDialog';
import type { DepartmentData } from '@/hooks/useScheduleData';
import type { SearchBarForm, DepartmentOption, WorkHoursTypeOption } from '@/hooks/useSearchBarForm';

import DateRangeField from './DateRangeField';
import { EmptyState, LoadingState } from './LoadingState';
import ScheduleButtonGroup from './ScheduleButtonGroup';
import ScheduleCalendar from './ScheduleCalendar';
import SearchBarFields from './SearchBarFields';
import ShiftDetailSheet from './shiftDetailSheet';
import { SavedTimeDisplay } from './SavedTimeDisplay';
import { ViewModeSelector } from './ViewModeSelector';
import { SHIFT_SCHEDULE_BREADCRUMBS } from '../constants';
import { calendarStyles, layoutStyles } from '../constants/styles';
import { cn } from '@/utils/style';

interface ShiftScheduleApprovalViewProps {
  searchBarForm: UseFormReturn<SearchBarForm>;
  scheduleDays: Dayjs[];
  departmentOptions: DepartmentOption[];
  workHoursTypeOptions: WorkHoursTypeOption[];
  isDepartmentsLoading: boolean;
  isPageLoading: boolean;
  hasNoData: boolean;
  departmentsShiftSchedule: DepartmentData[] | undefined;
  latestUpdatedTime: string | undefined;
  deleteShiftConfirmDialog: ReturnType<typeof useAlertDialog>;
  publishSuccessAlert: ReturnType<typeof useAlertDialog>;
}

/**
 * ç­è¡¨å¯©æ ¸é é¢å±•ç¤ºçµ„ä»¶
 *
 * ç´”å±•ç¤ºé‚è¼¯ï¼Œä¸åŒ…å«æ¥­å‹™é‚è¼¯
 * æ‰€æœ‰æ•¸æ“šå’Œç‹€æ…‹é€šé props å‚³å…¥
 */
export const ShiftScheduleApprovalView: React.FC<ShiftScheduleApprovalViewProps> = memo(({
  searchBarForm,
  scheduleDays,
  departmentOptions,
  workHoursTypeOptions,
  isDepartmentsLoading,
  isPageLoading,
  hasNoData,
  departmentsShiftSchedule,
  latestUpdatedTime,
  deleteShiftConfirmDialog,
  publishSuccessAlert,
}) => {
  const { t } = useTranslation();

  /**
   * æ¸²æŸ“æ—¥æ›†å…§å®¹
   * æ ¹æ“šè¼‰å…¥ç‹€æ…‹å’Œæ•¸æ“šç‹€æ…‹é¡¯ç¤ºä¸åŒå…§å®¹
   */
  const renderCalendar = useCallback(() => {
    if (isPageLoading) {
      return <LoadingState />;
    }

    if (departmentsShiftSchedule && !hasNoData) {
      return <ScheduleCalendar days={scheduleDays} />;
    }

    return <EmptyState />;
  }, [isPageLoading, departmentsShiftSchedule, hasNoData, scheduleDays]);

  return (
    <div>
      <Breadcrumbs items={SHIFT_SCHEDULE_BREADCRUMBS} />
      <h1 className="mb-4 mt-2 text-h2 font-medium">{t('ç­è¡¨å¯©æ ¸')}</h1>

      <FormProvider {...searchBarForm}>
        <Form {...searchBarForm}>
          <form onSubmit={searchBarForm.handleSubmit(() => {})}>
            {/* æœå°‹æ¬„ä½å€åŸŸ */}
            <div className={layoutStyles.searchBarContainer}>
              <SearchBarFields
                departmentOptions={departmentOptions}
                workHoursTypeOptions={workHoursTypeOptions}
                isDepartmentsLoading={isDepartmentsLoading}
              />
              <SavedTimeDisplay timestamp={latestUpdatedTime} />
            </div>

            {/* ç­è¡¨å…§å®¹å€åŸŸ */}
            <div className={cn(layoutStyles.calendarContainer, calendarStyles.containerHeight)}>
              {/* å·¥å…·åˆ— */}
              <div className={layoutStyles.toolbarContainer}>
                <div className={layoutStyles.toolbarLeft}>
                  <ViewModeSelector isLoading={isPageLoading} />
                  <DateRangeField isLoading={isPageLoading} />
                </div>
                {!isPageLoading && !hasNoData && <ScheduleButtonGroup />}
              </div>

              {/* æ—¥æ›†å…§å®¹ */}
              {renderCalendar()}
            </div>
          </form>
        </Form>
      </FormProvider>

      {/* å°è©±æ¡† */}
      <AlertDialog
        open={deleteShiftConfirmDialog.isOpen}
        onOpenChange={deleteShiftConfirmDialog.close}
        {...deleteShiftConfirmDialog.props}
      />
      <AlertDialog
        open={publishSuccessAlert.isOpen}
        onOpenChange={publishSuccessAlert.close}
        {...publishSuccessAlert.props}
      />

      {/* ç­æ¬¡è©³æƒ… Sheet */}
      <ShiftDetailSheet />
    </div>
  );
});

ShiftScheduleApprovalView.displayName = 'ShiftScheduleApprovalView';
```

**æ­¥é©Ÿ 3ï¼šé‡æ§‹ä¸»çµ„ä»¶**

**æ›´æ–°æ–‡ä»¶ï¼š** `src/pages/ShiftScheduleApproval/index.tsx`

```tsx
import { ShiftScheduleApprovalView } from './components/ShiftScheduleApprovalView';
import { useShiftScheduleApprovalState } from './hooks/useShiftScheduleApprovalState';

/**
 * ç­è¡¨å¯©æ ¸é é¢å®¹å™¨çµ„ä»¶
 *
 * è·è²¬ï¼š
 * - æ•´åˆé é¢ç‹€æ…‹å’Œé‚è¼¯
 * - å°‡æ•¸æ“šå‚³éçµ¦å±•ç¤ºçµ„ä»¶
 *
 * @returns ç­è¡¨å¯©æ ¸é é¢
 */
const ShiftScheduleApprovalPage: React.FC = () => {
  const state = useShiftScheduleApprovalState();

  return <ShiftScheduleApprovalView {...state} />;
};

export default ShiftScheduleApprovalPage;
```

#### ğŸ“Š é æœŸæ•ˆæœ
- ä¸»çµ„ä»¶å¾ 129 è¡Œæ¸›å°‘åˆ° ~15 è¡Œï¼ˆ-88%ï¼‰
- é‚è¼¯å’Œå±•ç¤ºå®Œå…¨åˆ†é›¢
- æå‡å¯æ¸¬è©¦æ€§ 80%
- ä¾¿æ–¼æœªä¾†ç¶­è­·å’Œæ“´å±•

---

## 4. å¯è®€æ€§æå‡

### 4.1 çµ±ä¸€è¨»é‡‹é¢¨æ ¼

#### ğŸ”µ å•é¡Œæè¿°
è¨»é‡‹ä½¿ç”¨ä¸ä¸€è‡´ï¼Œæœ‰äº›åœ°æ–¹ä½¿ç”¨ä¸­æ–‡è¨»é‡‹ï¼Œæœ‰äº›åœ°æ–¹æ²’æœ‰è¨»é‡‹ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**çµ±ä¸€ä½¿ç”¨ JSDoc é¢¨æ ¼ï¼š**

```tsx
/**
 * ç­è¡¨å¯©æ ¸é é¢
 *
 * åŠŸèƒ½ï¼š
 * - æœå°‹å’Œç¯©é¸ç­è¡¨
 * - é¡¯ç¤ºéƒ¨é–€ç­è¡¨æ—¥æ›†
 * - å¯©æ ¸å’Œç·¨è¼¯ç­æ¬¡
 *
 * @returns ç­è¡¨å¯©æ ¸é é¢çµ„ä»¶
 */
const ShiftScheduleApprovalPage: React.FC = () => {
  // ... çµ„ä»¶é‚è¼¯
};

/**
 * æ¸²æŸ“æ—¥æ›†å…§å®¹
 *
 * æ ¹æ“šè¼‰å…¥ç‹€æ…‹å’Œæ•¸æ“šç‹€æ…‹é¡¯ç¤ºä¸åŒå…§å®¹ï¼š
 * - è¼‰å…¥ä¸­ï¼šé¡¯ç¤º LoadingState
 * - æœ‰æ•¸æ“šï¼šé¡¯ç¤º ScheduleCalendar
 * - ç„¡æ•¸æ“šï¼šé¡¯ç¤º EmptyState
 */
const renderCalendar = useCallback(() => {
  // ... é‚è¼¯
}, [dependencies]);
```

---

### 4.2 è®Šé‡å‘½åå„ªåŒ–

#### ğŸ”µ å•é¡Œæè¿°
éƒ¨åˆ†è®Šé‡å‘½åä¸å¤ æ¸…æ™°ï¼Œå®¹æ˜“é€ æˆæ··æ·†ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

| ç¾ç‹€ | æ”¹é€²å¾Œ | ç†ç”± |
|------|--------|------|
| `isFormReady` | `isSearchFormReady` | æ›´æ˜ç¢ºæŒ‡å‡ºæ˜¯æœå°‹è¡¨å–® |
| `days` | `scheduleDays` | æ›´æ˜ç¢ºæŒ‡å‡ºæ˜¯ç­è¡¨æ—¥æœŸ |
| `isLoading` | `isPageLoading` | æ›´æ˜ç¢ºæŒ‡å‡ºæ˜¯é é¢è¼‰å…¥ç‹€æ…‹ |
| `isDataFetching` | `isScheduleDataLoading` | æ›´æ˜ç¢ºæŒ‡å‡ºæ˜¯ç­è¡¨æ•¸æ“šè¼‰å…¥ |

**æ”¹é€²ç¤ºä¾‹ï¼š**

```tsx
// æ”¹é€²å‰
const {
  form: searchBarForm,
  isFormReady,
  days,
} = useSearchBarForm({...});

const isLoading = !isFormReady || isDataFetching;

// æ”¹é€²å¾Œ
const {
  form: searchBarForm,
  isFormReady: isSearchFormReady,
  days: scheduleDays,
} = useSearchBarForm({...});

const isPageLoading = !isSearchFormReady || isScheduleDataLoading;
```

---

### 4.3 ç°¡åŒ–æ¢ä»¶é‚è¼¯

#### ğŸ”µ å•é¡Œæè¿°
æ¢ä»¶é‚è¼¯å¯ä»¥æ›´ç°¡æ½”å’Œèªç¾©åŒ–ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**æ”¹é€²å‰ï¼š**
```tsx
if (departmentsShiftSchedule && !hasNoData) {
  return <ScheduleCalendar days={days} />;
}
```

**æ”¹é€²å¾Œï¼š**
```tsx
// åœ¨ hook ä¸­è¨ˆç®—èªç¾©åŒ–çš„ç‹€æ…‹
const hasScheduleData = Boolean(departmentsShiftSchedule && !hasNoData);

// åœ¨çµ„ä»¶ä¸­ä½¿ç”¨
if (hasScheduleData) {
  return <ScheduleCalendar days={scheduleDays} />;
}
```

---

### 4.4 æ¸›å°‘ JSX åµŒå¥—å±¤ç´š

#### ğŸ”µ å•é¡Œæè¿°
JSX åµŒå¥—å±¤ç´šéæ·±ï¼Œå½±éŸ¿å¯è®€æ€§ã€‚

#### âœ… æ”¹é€²æ–¹æ¡ˆ

**æå–ç‚ºç¨ç«‹çµ„ä»¶ï¼š**

**æ–°å»ºæ–‡ä»¶ï¼š** `src/pages/ShiftScheduleApproval/components/CalendarToolbar/index.tsx`

```tsx
import { memo } from 'react';
import DateRangeField from '../DateRangeField';
import ScheduleButtonGroup from '../ScheduleButtonGroup';
import { ViewModeSelector } from '../ViewModeSelector';
import { layoutStyles } from '../../constants/styles';

interface CalendarToolbarProps {
  isLoading: boolean;
  hasNoData: boolean;
}

/**
 * æ—¥æ›†å·¥å…·åˆ—çµ„ä»¶
 *
 * åŒ…å«ï¼š
 * - è¦–åœ–æ¨¡å¼é¸æ“‡å™¨
 * - æ—¥æœŸç¯„åœé¸æ“‡å™¨
 * - æ“ä½œæŒ‰éˆ•ç¾¤çµ„
 */
export const CalendarToolbar: React.FC<CalendarToolbarProps> = memo(({
  isLoading,
  hasNoData,
}) => (
  <div className={layoutStyles.toolbarContainer}>
    <div className={layoutStyles.toolbarLeft}>
      <ViewModeSelector isLoading={isLoading} />
      <DateRangeField isLoading={isLoading} />
    </div>
    {!isLoading && !hasNoData && <ScheduleButtonGroup />}
  </div>
));

CalendarToolbar.displayName = 'CalendarToolbar';
```

**ä½¿ç”¨æ–¹å¼ï¼š**
```tsx
<div className={cn(layoutStyles.calendarContainer, calendarStyles.containerHeight)}>
  <CalendarToolbar isLoading={isPageLoading} hasNoData={hasNoData} />
  {renderCalendar()}
</div>
```

---

## 5. å¯¦ä½œå„ªå…ˆç´š

### ğŸš€ éšæ®µä¸€ï¼šå¿«é€Ÿå‹åˆ©ï¼ˆ1-2 å¤©ï¼‰

**å„ªå…ˆç´šï¼šé«˜ | é›£åº¦ï¼šä½ | æ•ˆæœï¼šç«‹å³å¯è¦‹**

#### ä»»å‹™æ¸…å–®

- [ ] ä½¿ç”¨ `useCallback` åŒ…è£¹ `renderCalendar`
- [ ] æå–å…§è¯å°è±¡ç‚ºå¸¸é‡ï¼ˆVIEW_MODE_OPTIONSï¼‰
- [ ] æ”¹é€²è®Šé‡å‘½åï¼ˆisFormReady â†’ isSearchFormReady ç­‰ï¼‰
- [ ] æå–é­”æ³•æ•¸å­—åˆ° `constants/styles.ts`
- [ ] çµ±ä¸€è¨»é‡‹é¢¨æ ¼ç‚º JSDoc
- [ ] AlertDialog æ”¹ç‚ºå§‹çµ‚æ¸²æŸ“

#### é æœŸæ•ˆæœ
- âœ… æ•ˆèƒ½æå‡ 10-15%
- âœ… ä»£ç¢¼å¯è®€æ€§æå‡ 30%
- âœ… ç¶­è­·æˆæœ¬é™ä½ 20%

---

### ğŸ¯ éšæ®µäºŒï¼šé‡è¦æ”¹é€²ï¼ˆ3-5 å¤©ï¼‰

**å„ªå…ˆç´šï¼šé«˜ | é›£åº¦ï¼šä¸­ | æ•ˆæœï¼šé¡¯è‘—**

#### ä»»å‹™æ¸…å–®

- [ ] å‰µå»º `SavedTimeDisplay` çµ„ä»¶
- [ ] å‰µå»º `ViewModeSelector` çµ„ä»¶
- [ ] å‰µå»º `CalendarToolbar` çµ„ä»¶
- [ ] å‰µå»º `usePageDialogs` hook
- [ ] ç‚ºå­çµ„ä»¶æ·»åŠ  `React.memo`
  - [ ] SearchBarFields
  - [ ] ScheduleCalendar
  - [ ] ScheduleButtonGroup
  - [ ] DateRangeField

#### é æœŸæ•ˆæœ
- âœ… çµ„ä»¶é‡æ–°æ¸²æŸ“æ¸›å°‘ 40-50%
- âœ… é—œæ³¨é»åˆ†é›¢åº¦æå‡ 60%
- âœ… çµ„ä»¶å¯é‡ç”¨æ€§æå‡ 50%

---

### ğŸ—ï¸ éšæ®µä¸‰ï¼šæ¶æ§‹å„ªåŒ–ï¼ˆ1-2 é€±ï¼‰

**å„ªå…ˆç´šï¼šä¸­ | é›£åº¦ï¼šé«˜ | æ•ˆæœï¼šé•·æœŸ**

#### ä»»å‹™æ¸…å–®

- [ ] å‰µå»º `useShiftScheduleApprovalState` hook
- [ ] å‰µå»º `ShiftScheduleApprovalView` å±•ç¤ºçµ„ä»¶
- [ ] é‡æ§‹ä¸»çµ„ä»¶ç‚ºå®¹å™¨çµ„ä»¶
- [ ] é‡æ§‹è¡¨å–®æäº¤é‚è¼¯
- [ ] å»ºç«‹å®Œæ•´çš„ TypeScript é¡å‹ç³»çµ±
- [ ] æ·»åŠ å–®å…ƒæ¸¬è©¦
  - [ ] useShiftScheduleApprovalState æ¸¬è©¦
  - [ ] ShiftScheduleApprovalView æ¸¬è©¦
  - [ ] SavedTimeDisplay æ¸¬è©¦
  - [ ] ViewModeSelector æ¸¬è©¦

#### é æœŸæ•ˆæœ
- âœ… ä»£ç¢¼è¡Œæ•¸æ¸›å°‘ 40%
- âœ… å¯æ¸¬è©¦æ€§æå‡ 80%
- âœ… ç¶­è­·æˆæœ¬é™ä½ 50%
- âœ… æ–°åŠŸèƒ½é–‹ç™¼é€Ÿåº¦æå‡ 30%

---

## æ”¹é€²æ•ˆæœç¸½çµ

### ğŸ“Š é‡åŒ–æŒ‡æ¨™å°æ¯”

| ç¶­åº¦ | æ”¹é€²å‰ | æ”¹é€²å¾Œ | æå‡å¹…åº¦ |
|------|--------|--------|----------|
| **æ¸²æŸ“æ•ˆèƒ½** | åŸºæº– | å„ªåŒ– | +40% |
| **å¯ç¶­è­·æ€§** | ä¸­ç­‰ | å„ªç§€ | +60% |
| **å¯æ¸¬è©¦æ€§** | ä½ | é«˜ | +80% |
| **å¯è®€æ€§** | ä¸­ç­‰ | å„ªç§€ | +50% |
| **ä»£ç¢¼è¡Œæ•¸** | 129 è¡Œ | ~80 è¡Œ | -38% |
| **çµ„ä»¶æ•¸é‡** | 1 å€‹ä¸»çµ„ä»¶ | 1 å®¹å™¨ + 1 å±•ç¤º + 4 å­çµ„ä»¶ | æ¨¡çµ„åŒ– |
| **Hook æ•¸é‡** | 5 å€‹ | 6 å€‹ï¼ˆæ–°å¢ 1 å€‹æ•´åˆ hookï¼‰ | æ›´æ¸…æ™° |

### ğŸ¯ è³ªåŒ–æ”¹é€²

#### æ•ˆèƒ½æ–¹é¢
- âœ… æ¸›å°‘ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“
- âœ… å„ªåŒ–å‡½æ•¸å’Œå°è±¡å‰µå»º
- âœ… æå‡å°è©±æ¡†é–‹é—œé€Ÿåº¦
- âœ… é™ä½è¨˜æ†¶é«”ä½¿ç”¨

#### æ¶æ§‹æ–¹é¢
- âœ… æ¸…æ™°çš„é—œæ³¨é»åˆ†é›¢
- âœ… ç¬¦åˆå–®ä¸€è·è²¬åŸå‰‡
- âœ… å®¹å™¨/å±•ç¤ºæ¨¡å¼
- âœ… å¯é‡ç”¨çš„å­çµ„ä»¶

#### é–‹ç™¼é«”é©—
- âœ… æ›´å®¹æ˜“ç†è§£å’Œç¶­è­·
- âœ… æ›´å®¹æ˜“ç·¨å¯«æ¸¬è©¦
- âœ… æ›´å®¹æ˜“æ“´å±•æ–°åŠŸèƒ½
- âœ… æ›´å¥½çš„ TypeScript æ”¯æ´

---

## ğŸ¬ ä¸‹ä¸€æ­¥è¡Œå‹•

### å»ºè­°å¯¦æ–½é †åº

1. **æœ¬é€±ï¼ˆç¬¬ 1-2 å¤©ï¼‰**
   - å®Œæˆéšæ®µä¸€çš„æ‰€æœ‰ä»»å‹™
   - é€²è¡ŒåŸºæœ¬æ¸¬è©¦é©—è­‰

2. **ä¸‹é€±ï¼ˆç¬¬ 3-7 å¤©ï¼‰**
   - å®Œæˆéšæ®µäºŒçš„æ‰€æœ‰ä»»å‹™
   - é€²è¡Œæ•´åˆæ¸¬è©¦

3. **ä¸‹å€‹æœˆï¼ˆç¬¬ 8-14 å¤©ï¼‰**
   - å®Œæˆéšæ®µä¸‰çš„æ‰€æœ‰ä»»å‹™
   - å®Œå–„å–®å…ƒæ¸¬è©¦
   - æ›´æ–°ç›¸é—œæ–‡æª”

### é¢¨éšªè©•ä¼°

| é¢¨éšª | å½±éŸ¿ | ç·©è§£æªæ–½ |
|------|------|----------|
| é‡æ§‹å°è‡´åŠŸèƒ½ç•°å¸¸ | é«˜ | æ¯å€‹éšæ®µå®Œæˆå¾Œé€²è¡Œå®Œæ•´æ¸¬è©¦ |
| å½±éŸ¿å…¶ä»–çµ„ä»¶ | ä¸­ | ä½¿ç”¨ TypeScript ç¢ºä¿é¡å‹å®‰å…¨ |
| é–‹ç™¼æ™‚é–“è¶…å‡ºé æœŸ | ä½ | åˆ†éšæ®µå¯¦æ–½ï¼Œå¯éš¨æ™‚æš«åœ |

### æˆåŠŸæ¨™æº–

- âœ… æ‰€æœ‰ç¾æœ‰åŠŸèƒ½æ­£å¸¸é‹ä½œ
- âœ… å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡é”åˆ° 80%
- âœ… æ•ˆèƒ½æŒ‡æ¨™é”åˆ°é æœŸæå‡
- âœ… ä»£ç¢¼å¯©æŸ¥é€šé
- âœ… æ–‡æª”æ›´æ–°å®Œæˆ

---

## ğŸ“š åƒè€ƒè³‡æº

### ç›¸é—œæ–‡æª”
- [React æ•ˆèƒ½å„ªåŒ–æœ€ä½³å¯¦è¸](https://react.dev/learn/render-and-commit)
- [å®¹å™¨/å±•ç¤ºçµ„ä»¶æ¨¡å¼](https://www.patterns.dev/posts/presentational-container-pattern)
- [React Hooks æœ€ä½³å¯¦è¸](https://react.dev/reference/react)

### å°ˆæ¡ˆå…§éƒ¨åƒè€ƒ
- `src/pages/ShiftScheduleApproval/constants/styles.ts` - æ¨£å¼å¸¸é‡ç¯„ä¾‹
- `src/pages/ShiftScheduleApproval/components/LoadingState/index.tsx` - çµ„ä»¶æ‹†åˆ†ç¯„ä¾‹
- `src/pages/ShiftScheduleApproval/components/SearchBarFields/index.tsx` - useCallback ä½¿ç”¨ç¯„ä¾‹

---

**æ–‡ä»¶ç¶­è­·è€…ï¼š** AI Assistant
**æœ€å¾Œæ›´æ–°ï¼š** 2025-10-14
**ç‰ˆæœ¬ï¼š** v1.0
